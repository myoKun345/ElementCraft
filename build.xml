<?xml version="1.0" encoding="UTF-8" ?>

<project name="ElementalExperimentation" default="build">

	<target name="build">
		<delete dir="../Forge/forge/mcp/src/minecraft/elex" />
		<mkdir dir="../Forge/forge/mcp/src/minecraft/elex" />
		
		<delete dir="../../jobs/ElementalExperimentation/toJar" />
		<mkdir dir="../../jobs/ElementalExperimentation/toJar" />
		
		<delete dir="../../jobs/ElementalExperimentation/toDeobf" />
		<mkdir dir="../../jobs/ElementalExperimentation/toDeobf" />
		
		<delete dir="jars" />
		<mkdir dir="jars" />
		
		<delete dir="deobf" />
		<mkdir dir="deobf" />
		
		<replace file="elex_common/mcmod.info" token="@@BUILD@@" value="${build_number}" />
		<replace file="elex_common/elex/lib/Reference.java" token="@@BUILD@@" value="${build_number}" />
		
		<copy todir="../Forge/forge/mcp/src/minecraft">
			
			<fileset dir="elex_common/" />
			
		</copy>
		
		<copy todir="../../jobs/ElementalExperimentation/toJar" file="elex_common/mcmod.info" />
		
		<copy todir="../../jobs/ElementalExperimentation/toJar">
			
			<fileset dir="resources/" />
			
		</copy>
		
		<copy todir="../../jobs/ElementalExperimentation/toDeobf" file="elex_common/mcmod.info" />
		
		<copy todir="../../jobs/ElementalExperimentation/toDeobf">
			
			<fileset dir="resources/" />
			
		</copy>

		<exec executable="../Forge/forge/mcp/recompile.sh" dir="../Forge/forge/mcp" resolveexecutable="true" osfamily="unix"></exec>

		<exec executable="../Forge/forge/mcp/reobfuscate_srg.sh" dir="../Forge/forge/mcp" resolveexecutable="true" osfamily="unix"></exec>

		<copy todir="../../jobs/ElementalExperimentation/toJar/elex">

			<fileset dir="../Forge/forge/mcp/reobf/minecraft/elex" />

		</copy>
		
		<copy todir="../../jobs/ElementalExperimentation/toJar/buildcraft">

			<fileset dir="../Forge/forge/mcp/reobf/minecraft/buildcraft" />

		</copy>
		
		<copy todir="../../jobs/ElementalExperimentation/toJar/ic2">

			<fileset dir="../Forge/forge/mcp/reobf/minecraft/ic2" />

		</copy>
		
		<copy todir="../../jobs/ElementalExperimentation/toJar/thermalexpansion">

			<fileset dir="../Forge/forge/mcp/reobf/minecraft/thermalexpansion" />

		</copy>
		
		<copy todir="../../jobs/ElementalExperimentation/toJar/universalelectricity">

			<fileset dir="../Forge/forge/mcp/reobf/minecraft/universalelectricity" />

		</copy>
		
		<copy todir="../../jobs/ElementalExperimentation/toDeobf/elex">

			<fileset dir="../Forge/forge/mcp/bin/minecraft/elex" />

		</copy>
		
		<copy todir="../../jobs/ElementalExperimentation/toDeobf/buildcraft">

			<fileset dir="../Forge/forge/mcp/bin/minecraft/buildcraft" />

		</copy>
		
		<copy todir="../../jobs/ElementalExperimentation/toDeobf/ic2">

			<fileset dir="../Forge/forge/mcp/bin/minecraft/ic2" />

		</copy>
		
		<copy todir="../../jobs/ElementalExperimentation/toDeobf/thermalexpansion">

			<fileset dir="../Forge/forge/mcp/bin/minecraft/thermalexpansion" />

		</copy>
		
		<copy todir="../../jobs/ElementalExperimentation/toDeobf/universalelectricity">

			<fileset dir="../Forge/forge/mcp/bin/minecraft/universalelectricity" />

		</copy>
		
		<jar destfile="jars/ElementalExperimentation-0.0.01.${build_number}.jar" basedir="../../jobs/ElementalExperimentation/toJar" />
		<jar destfile="deobf/ElementalExperimentation-deobf-0.0.01.${build_number}.jar" basedir="../../jobs/ElementalExperimentation/toDeobf" />

	</target>

</project>
